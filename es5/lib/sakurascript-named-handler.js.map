{"version":3,"sources":["lib/sakurascript-named-handler.js"],"names":[],"mappings":"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","file":"sakurascript-named-handler.js","sourcesContent":["import {SakuraScript, SakuraScriptToken} from 'sakurascript';\r\n\r\nexport class SakuraScriptNamedHandler {\r\n  constructor(named) {\r\n    this._named = named;\r\n  }\r\n\r\n  get named() { return this._named; }\r\n\r\n  execute(token) {\r\n    const named = this.named;\r\n    const scope = named.scope();\r\n    const surface = scope.surface();\r\n    const blimp = scope.blimp();\r\n    if (token instanceof SakuraScriptToken.Scope) {\r\n      named.scope(token.scope);\r\n    } else if (token instanceof SakuraScriptToken.Surface) {\r\n      scope.surface(token.surface);\r\n    } else if (token instanceof SakuraScriptToken.SurfaceAlias) {\r\n      scope.surface(token.surface_alias);\r\n    } else if (token instanceof SakuraScriptToken.Balloon) {\r\n      scope.blimp(token.balloon);\r\n    } else if (token instanceof SakuraScriptToken.PlayAnimation) {\r\n      surface.play(token.animation);\r\n    } else if (token instanceof SakuraScriptToken.PlayAnimationWait) {\r\n      surface.play(token.animation);\r\n    } else if (token instanceof SakuraScriptToken.SimpleWait) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.PreciseWait) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.WaitFromBeginning) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.ResetBeginning) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.WaitAnimationEnd) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.ToggleQuick) {\r\n      return true;\r\n    } else if (token instanceof SakuraScriptToken.ToggleSynchronize) {\r\n      // TODO syncro section\r\n    } else if (token instanceof SakuraScriptToken.TimeCritical) {\r\n      // TODO set time critical to state model\r\n    } else if (token instanceof SakuraScriptToken.WaitClick) {\r\n      named.scope(0).blimp().showWait();\r\n    } else if (token instanceof SakuraScriptToken.NoChoiceTimeout) {\r\n      // TODO state\r\n    } else if (token instanceof SakuraScriptToken.EventChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choice(token.text, token.event, ...token.references);\r\n    } else if (token instanceof SakuraScriptToken.ReferencesChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(token.text, ...token.references);\r\n    } else if (token instanceof SakuraScriptToken.ScriptChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(token.text, `script:${token.script}`);\r\n    } else if (token instanceof SakuraScriptToken.OldReferenceChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(token.text, token.reference);\r\n      blimp.br();\r\n    } else if (token instanceof SakuraScriptToken.BeginEventChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(token.event, ...token.references);\r\n    } else if (token instanceof SakuraScriptToken.BeginReferencesChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(...token.references);\r\n    } else if (token instanceof SakuraScriptToken.BeginScriptChoice) {\r\n      // TODO state.has_choice = true;\r\n      blimp.choiceBegin(`script:${token.script}`);\r\n    } else if (token instanceof SakuraScriptToken.EndChoice) {\r\n      blimp.choiceEnd();\r\n    } else if (token instanceof SakuraScriptToken.BeginEventAnchor) {\r\n      blimp.anchorBegin(token.event, ...token.references);\r\n    } else if (token instanceof SakuraScriptToken.BeginReferencesAnchor) {\r\n      blimp.anchorBegin(...token.references);\r\n    } else if (token instanceof SakuraScriptToken.BeginScriptAnchor) {\r\n      blimp.anchorBegin(`script:${token.script}`);\r\n    } else if (token instanceof SakuraScriptToken.EndAnchor) {\r\n      blimp.anchorEnd();\r\n    } else if (token instanceof SakuraScriptToken.LineBreak) {\r\n      blimp.br();\r\n    } else if (token instanceof SakuraScriptToken.HalfLineBreak) {\r\n      blimp.br(0.5);\r\n    } else if (token instanceof SakuraScriptToken.PercentLineBreak) {\r\n      blimp.br(token.percent / 100);\r\n    } else if (token instanceof SakuraScriptToken.ToggleNoAutoLineBreak) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Location) {\r\n      blimp.location(token.x, token.y);\r\n    } else if (token instanceof SakuraScriptToken.Image) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.InlineImage) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Font) {\r\n      blimp.font(token.name, ...token.args);\r\n    } else if (token instanceof SakuraScriptToken.BeFar) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.BeNear) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Clear) {\r\n      blimp.clear();\r\n    } else if (token instanceof SakuraScriptToken.End) {\r\n      surface.yenE();\r\n    } else if (token instanceof SakuraScriptToken.OldChoiceEnd) {\r\n      surface.yenE();\r\n    } else if (token instanceof SakuraScriptToken.OpenCommunicateBox) {\r\n      named.openCommunicateBox();\r\n    } else if (token instanceof SakuraScriptToken.OpenTeachBox) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Halt) {\r\n      surface.yenE();\r\n      return false;\r\n    } else if (token instanceof SakuraScriptToken.Marker) {\r\n      blimp.marker();\r\n    } else if (token instanceof SakuraScriptToken.Char) {\r\n      // TODO syncro\r\n      blimp.talk(token.char);\r\n    } else if (token instanceof SakuraScriptToken.Animation) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Bind) {\r\n      if (token.dress_up == null) {\r\n        // TODO toggle\r\n      } else if (token.dress_up){\r\n        scope.bind(token.category, token.parts);\r\n      } else {\r\n        scope.unbind(token.category, token.parts);\r\n      }\r\n    } else if (token instanceof SakuraScriptToken.LockRepaint) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.UnlockRepaint) {\r\n      // TODO cuttlebone not implemented\r\n    } else if (token instanceof SakuraScriptToken.Move) {\r\n      // TODO shell state\r\n    } else if (token instanceof SakuraScriptToken.MoveAsync) {\r\n      // TODO shell state\r\n    } else if (token instanceof SakuraScriptToken.MoveAsyncCancel) {\r\n      // TODO shell state\r\n    } else if (token instanceof SakuraScriptToken.Raise) {\r\n      return false;\r\n    } else if (token instanceof SakuraScriptToken.Set) {\r\n      // TODO\r\n    } else if (token instanceof SakuraScriptToken.Open) {\r\n      // TODO\r\n    } else if (token instanceof SakuraScriptToken.Close) {\r\n      // TODO\r\n    } else if (token instanceof SakuraScriptToken.NotImplemented) {\r\n      return true;\r\n    } else {\r\n      return false;\r\n    }\r\n    return true;\r\n  }\r\n}\r\n"]}